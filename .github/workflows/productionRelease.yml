name: Update Version on Production

on:
  release:
    types:
      - released

permissions: write-all

jobs:
  update_version:
    name: "[chore] Merge pull request from release to production"
    runs-on: ubuntu-latest
    timeout-minutes: 8
    steps:
      - name: Run auto-merge-action
        id: run-auto-merge-action
        uses: yyoshiki41/auto-merge-action@v1
        with:
          github-token: ${{ secrets.MERGE_TOKEN }}
          base: master
          head: release
          title: ${{github.event.release.name}}

      - name: Slack Production Notification
        uses: bryannice/gitactions-slack-notification@2.0.0
        env:
          SLACK_INCOMING_WEBHOOK: ${{ secrets.SLACK_INCOMING_WEBHOOK }}
          SLACK_MESSAGE: "The production release has been merged for the backend"
          SLACK_TITLE: "Production Release"
